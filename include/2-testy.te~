\chapter{Problém bandity}

Jako testovací problém jsem použil problém vícerukého bandity: bandita stojí před neznámým automatem s $K$ pákami a snaží se vhodným výběrem páky maximalizovat svůj zisk na časovém horizontu $n$. V každém časovém okamžiku $t = \adob{1}{n}$ vybírá pouze na základě své zkušenosti ruku $A_t \in \hat K$ a získává odměnu $X_t^{(A_t)}$. Výše odměny od ruky $a$ je náhodná veličina, která je nezávislá na čase, na předchozích realizacích i na ostatních rukou.

Strategie bandity je rozhodovací pravidlo, které pro každé pozorování $(\adob{A_1, X_1}{A_{t-1}, \newline X_{t-1}})$ určí další ruku $A_t$; může být znáhodněné. Nejlepší je zřejmě vybrat tu ruku $a^*$, jež má maximální střední odměnu $\mu_{a^*}$, ale bandita neví, která to je. Proto se pro měření \uv{výkonu} bandity zavádí veličina
\begin{equation}
	R_n = n \mu_{a^*} - \sum\limits_{a \in \hat K} S_a(n) ,
\end{equation}
kde $S_a(n)$ značí součet odměn získaných od ruky $a$. Má význam ztráty oproti střední odměně bandity se znalostí parametrů automatu.

Bandita řeší dilema nastíněné v poznámce \ref{pozn:dilemma} -- zda vybrat automat, který na základě pozorování dává největší zisk, nebo zkoušet i ty, které dávají menší zisk, přitom mohou mít ve skutečnosti lepší střední odměnu (z malého počtu pozorování například těžko odliším 0.8 a 0.85 pro Bernoulliho automaty).

Nyní se blíže podíváme na automaty s Bernoulliho rozdělením. Pro výpočet aposteriorní hustoty pravděpodobnosti neznámého parametru $\theta$ pevně zvoleného automatu (díky nezávislosti automatů můžeme jejich hustoty počítat odděleně) potřebujeme nejprve znát apriorní rozdělení. To budeme předpokládat uniformní (nulová znalost automatu), což je ekvivalentní rozdělení $Beta(1,1)$. Při použití rekurzivního Bayesova učení (\eqref{eqn:bay_uc}) lze snadno indkucí dokázat, že se zachová rozdělení Beta, konkrétně máme po $N$ taženích $Beta(S_N+1, N-S_N+1)$, kde $S_N$ značí dosavadní zisk. Vypočteme-li aposteriorní rozdělení v $N$-tém kroku přímo použitím statistiky $(N, S_N)$, dostáváme
\begin{align*}
	p(\theta \mid N, S_N) &= \frac{p(N, S_N \mid \theta) \; p_0(\theta)}{\int p(N, S_N \mid \theta) \; p_0(\theta) \de \theta} = \\
	&= \frac{\binom{N}{S_N} \, \theta^{S_N} (1-\theta)^{N-S_N} \cdot 1}{\int \binom{N}{S_N} \, \theta^{S_N} (1-\theta)^{N-S_N} \cdot 1 \de \theta} \sim \\
	&\sim Beta(S_N+1, N-S_N+1) ,
\end{align*}
kde binomické rozdělení ve druhém řádku plyne z nezávislosti automatu na historii. Dospěli jsme ke stejnému výsledku, banditovi tak stačí pro danou ruku pracovat pouze s dvojicí $(N, S_N)$.

\input{./include/2-testy_1-bandita.tex}

\input{./include/2-testy_2-KL-UCB.tex}

\input{./include/2-testy_3-moje.tex}

\input{./include/2-testy_4-optimal.tex}

\input{./include/2-testy_5-ltd.tex}

\input{./include/2-testy_6-testy.tex}
